# Git Tips

This note contains operation related tips. See [[cross-platform/git]] for configuration tips.

- [Commit message convention](#commit-message-convention)
- [Change commit messages](#change-commit-messages)
- [Clone to a specific directory](#clone-to-a-specific-directory)
- [Embedded repo](#embedded-repo)
- [Update an unchecked-out local branch from remote branch](#update-an-unchecked-out-local-branch-from-remote-branch)
- [Discard unstaged changes](#discard-unstaged-changes)
- [Stash changes](#stash-changes)
- [Rename branch](#rename-branch)
- [Change remote origin](#change-remote-origin)
- [Hard reset remote branch](#hard-reset-remote-branch)
- [Private fork](#private-fork)

## Commit message convention

*References*:

- [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/)

## Change commit messages

- Change the last one: `git commit --amend`
- [ ] Change multiple

*References*:

- [Changing a commit message](https://docs.github.com/en/pull-requests/committing-changes-to-your-project/creating-and-editing-commits/changing-a-commit-message)

## Clone to a specific directory

Use `git clone git@github.com:SOME_REPO TARGET_DIRECTORY`.

*References*:

- [How to 'git pull' into a branch that is not the current one?](https://stackoverflow.com/questions/651038/how-do-i-clone-a-git-repository-into-a-specific-folder)

## Embedded repo

*References*:

- [Git: How to make outer repository and embedded repository work as common/standalone repository?](https://stackoverflow.com/questions/47008290/git-how-to-make-outer-repository-and-embedded-repository-work-as-common-standal)

## Update an unchecked-out local branch from remote branch

Use `git fetch REMOTE_REPO REMOTE_BRANCH:LOCAL_BRANCH`.

## Discard unstaged changes

- Discard all: `git restore .`
- Discard a specific file: `git restore PATH_TO_THE_FILE`

*References*:

- [How To Completely Reset a Git Repository (Including Untracked Files)](https://www.howtogeek.com/devops/how-to-completely-reset-a-git-repository-including-untracked-files/)

## Stash changes

- Stash changes by `git stash`.
- Pop stash by `git stash pop`.

*References*:

- [Git stash](https://www.atlassian.com/git/tutorials/saving-changes/git-stash)

## Rename branch

- Rename checked-out local branch: Use `git branch --move NEW_BRANCH_NAME`.
- Rename unchecked-out local branch: Use `git branch --move BRANCH_NAME NEW_BRANCH_NAME`.

## Change remote origin

Use `git remote set-url REMOTE_NAME NEW_URL`.

*References*:

- [How To Change Git Remote Origin](https://devconnected.com/how-to-change-git-remote-origin/)

## Hard reset remote branch

After hard resetting the local repo, use `git push -f REMOTE_REPO BRANCH_NAME` to hard reset the remote repo.

## Private fork

1. Create a new repo (`PRI_REPO`) via the GitHub Website.
2. Duplicate the public repo (`PUB_REPO`) via the following commands:

   ```bash
   git clone --bare https://github.com/exampleuser/PUB_REPO.git
   cd PUB_REPO.git
   git push --mirror https://github.com/yourname/PRI_REPO.git
   cd ..
   rm -rf PUB_REPO.git
   ```

3. Clone the private repo and add `upstream` via the following commands:

   ```bash
   git clone https://github.com/yourname/PRI_REPO.git
   cd PRI_REPO
   git remote add upstream https://github.com/exampleuser/PUB_REPO.git
   git remote set-url --push upstream DISABLE # Optional
   ```

   - Pull updates from `upstream` via the following commands:

     ```bash
     git pull upstream master # Creates a merge commit
     ```

   - Push to `PRI_REPO`:

     ```bash
     git push origin master
     ```

*References*:

- [GitHub: How to make a fork of public repository private?](https://stackoverflow.com/questions/10065526/github-how-to-make-a-fork-of-PUB_REPOsitory-private)
- [Create a private fork of a public repository](https://gist.github.com/0xjac/85097472043b697ab57ba1b1c7530274)
- [Duplicating a repository](https://docs.github.com/en/repositories/creating-and-managing-repositories/duplicating-a-repository)

[//begin]: # "Autogenerated link references for markdown compatibility"
[cross-platform/git]: ../notes-OS/cross-platform/git.md "Git Configuration"
[//end]: # "Autogenerated link references"
